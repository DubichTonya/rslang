(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{cRhG:function(r,e,o){"use strict";o.r(e),o.d(e,"ProfileModule",function(){return O});var t=o("ofXK"),i=o("3Pt+"),n=o("tyNb"),a=o("hctd"),l=o("PCNd"),s=o("eqRq"),c=o("Ra8W"),m=o("fXoL"),b=o("f4AX"),p=o("Y45k"),u=o("l7P3"),f=o("dNgK"),d=o("kmnG"),g=o("qFsG"),h=o("s3XV"),C=o("bTqV"),_=o("1P0b");function v(r,e){1&r&&(m.Sb(0,"mat-error"),m.Ec(1," \u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u043b\u0438\u0434\u043d\u044b\u0439 email "),m.Rb())}function E(r,e){1&r&&(m.Sb(0,"mat-error"),m.Ec(1," Email "),m.Sb(2,"strong"),m.Ec(3,"\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u0435\u043d"),m.Rb(),m.Rb())}function F(r,e){1&r&&(m.Sb(0,"mat-error"),m.Ec(1," Username is required "),m.Rb())}function S(r,e){1&r&&(m.Sb(0,"mat-error"),m.Ec(1," Username should be 3 characters min "),m.Rb())}function P(r,e){if(1&r&&(m.Sb(0,"div",11),m.Ec(1),m.Rb()),2&r){const r=m.dc();m.Cb(1),m.Fc(r.serverError)}}function y(r,e){1&r&&m.Ob(0,"app-progress")}const R=[{path:"",component:(()=>{class r{constructor(r,e,o,t,n,a,l){this.fb=r,this.userService=e,this.router=o,this.route=t,this.parser=n,this.store=a,this.snackBar=l,this.serverError=null,this.loading=!1,this.usernameFormControl=r.control("",[i.n.required,i.n.minLength(3)]),this.emailFormControl=r.control({value:"",disabled:!0},[i.n.required,i.n.email]),this.imageFormControl=r.control(null),this.profileForm=r.group({username:this.usernameFormControl,email:this.emailFormControl,image:this.imageFormControl}),this.profileForm.valueChanges.subscribe(()=>{this.serverError&&(this.serverError=null)})}ngOnInit(){this.userId=this.route.snapshot.params.id,this.storeSubscription=this.store.select(s.d).subscribe(r=>{r&&(this.profileForm.patchValue(r),this.imagePreview=r.image)})}ngOnDestroy(){this.storeSubscription&&this.storeSubscription.unsubscribe()}updateProfile(r){r.preventDefault(),this.loading=!0;const{email:e,username:o,image:t=""}=this.profileForm.value;this.profileForm.valid&&this.userService.updateUser(this.userId,{email:e,username:o,image:t}).subscribe(r=>{r&&(this.store.dispatch(Object(c.c)({payload:r})),this.snackBar.open("\u0414\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0431\u044b\u043b\u0438 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b","",{duration:2e3}))},({error:r})=>{this.serverError="string"==typeof r?r:this.parser.parseError(null==r?void 0:r.error),this.loading=!1},()=>{this.loading=!1})}onLoadImage(r){var e;this.imagePreview=r,this.profileForm.patchValue({image:r}),null===(e=this.profileForm.get("image"))||void 0===e||e.updateValueAndValidity()}}return r.\u0275fac=function(e){return new(e||r)(m.Nb(i.c),m.Nb(b.a),m.Nb(n.c),m.Nb(n.a),m.Nb(p.a),m.Nb(u.h),m.Nb(f.a))},r.\u0275cmp=m.Hb({type:r,selectors:[["app-profile-page"]],decls:24,vars:11,consts:[[1,"profile"],[1,"color-text-togglable"],["novalidate","",1,"profile__form",3,"formGroup","submit"],[1,"profile__form-field-container"],["appearance","outline",1,"profile__form-field"],["type","email","matInput","","placeholder","Email",3,"formControl"],[4,"ngIf"],["type","text","matInput","","placeholder","\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",3,"formControl"],[3,"image","loadFileEvent"],["type","submit","mat-stroked-button","",1,"profile__submit-btn",3,"disabled"],["class","mat-error profile__server-error",4,"ngIf"],[1,"mat-error","profile__server-error"]],template:function(r,e){1&r&&(m.Sb(0,"div",0),m.Sb(1,"h1",1),m.Ec(2,"\u041f\u0440\u043e\u0444\u0430\u0439\u043b \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"),m.Rb(),m.Sb(3,"form",2),m.Zb("submit",function(r){return e.updateProfile(r)}),m.Sb(4,"div",3),m.Sb(5,"mat-form-field",4),m.Sb(6,"mat-label"),m.Ec(7,"Email"),m.Rb(),m.Ob(8,"input",5),m.Cc(9,v,2,0,"mat-error",6),m.Cc(10,E,4,0,"mat-error",6),m.Rb(),m.Rb(),m.Sb(11,"div",3),m.Sb(12,"mat-form-field",4),m.Sb(13,"mat-label"),m.Ec(14,"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"),m.Rb(),m.Ob(15,"input",7),m.Cc(16,F,2,0,"mat-error",6),m.Cc(17,S,2,0,"mat-error",6),m.Rb(),m.Rb(),m.Sb(18,"div",3),m.Sb(19,"app-file-input",8),m.Zb("loadFileEvent",function(r){return e.onLoadImage(r)}),m.Rb(),m.Rb(),m.Sb(20,"button",9),m.Ec(21," \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c "),m.Rb(),m.Cc(22,P,2,1,"div",10),m.Rb(),m.Cc(23,y,1,0,"app-progress",6),m.Rb()),2&r&&(m.Cb(3),m.jc("formGroup",e.profileForm),m.Cb(5),m.jc("formControl",e.emailFormControl),m.Cb(1),m.jc("ngIf",e.emailFormControl.hasError("email")&&!e.emailFormControl.hasError("required")),m.Cb(1),m.jc("ngIf",e.emailFormControl.hasError("required")),m.Cb(5),m.jc("formControl",e.usernameFormControl),m.Cb(1),m.jc("ngIf",e.usernameFormControl.hasError("required")),m.Cb(1),m.jc("ngIf",e.usernameFormControl.hasError("minlength")),m.Cb(2),m.jc("image",e.imagePreview),m.Cb(1),m.jc("disabled",e.profileForm.invalid),m.Cb(2),m.jc("ngIf",e.serverError),m.Cb(1),m.jc("ngIf",e.loading))},directives:[i.o,i.k,i.e,d.c,d.f,g.a,i.b,i.j,i.d,t.m,h.a,C.b,d.b,_.a],styles:["[_nghost-%COMP%]{width:100%}input[_ngcontent-%COMP%]{color:var(--color-text-togglable)}.profile[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem}.profile__form[_ngcontent-%COMP%]{width:18rem}.profile__form-field-container[_ngcontent-%COMP%]:not(:last-child){margin-bottom:1.2rem}.profile__form-field[_ngcontent-%COMP%]{width:100%}.profile__visibility-icon[_ngcontent-%COMP%]{cursor:pointer}.profile__server-error[_ngcontent-%COMP%]{margin:1.5rem auto;display:flex;align-items:center;justify-content:center}.profile__submit-btn[_ngcontent-%COMP%]{width:100%;height:3rem;background-color:var(--color-primary);color:var(--color-text-togglable);text-transform:uppercase}.profile__go-login[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:1rem}.profile__go-login-text[_ngcontent-%COMP%]{opacity:.5}.profile__go-login-link[_ngcontent-%COMP%]{display:inline-block;margin-left:.5rem;text-decoration:none}"]}),r})()}];let O=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=m.Lb({type:r}),r.\u0275inj=m.Kb({imports:[[t.c,i.m,n.g.forChild(R),a.a,l.a]]}),r})()}}]);